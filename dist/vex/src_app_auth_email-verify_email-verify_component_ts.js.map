{"version":3,"file":"src_app_auth_email-verify_email-verify_component_ts.js","mappings":"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","sources":["./src/app/auth/email-verify/email-verify.component.ts","./src/app/auth/email-verify/email-verify.component.html"],"sourcesContent":["import { NgIf } from '@angular/common';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport {\r\n  ChangeDetectorRef,\r\n  Component,\r\n  OnInit,\r\n  NgZone,\r\n  signal\r\n} from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { fadeInUp400ms } from '@vex/animations/fade-in-up.animation';\r\nimport { ParamsEmailVerify } from 'src/app/interfaces/Params-email-verify';\r\nimport { AuthService } from 'src/app/services/auth-service';\r\nimport { ResponseGlobalServer } from 'src/app/interfaces/Response-globalServer';\r\nimport { EmailNotVerifyExpiryComponent } from '../email-not-verify-expiry/email-not-verify-expiry.component';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\n@Component({\r\n  selector: 'vex-email-verify',\r\n  templateUrl: './email-verify.component.html',\r\n  styleUrls: ['../auth.component.scss'],\r\n  animations: [fadeInUp400ms],\r\n  standalone: true,\r\n  imports: [\r\n    MatIconModule,\r\n    NgIf,\r\n    MatButtonModule,\r\n    MatProgressSpinnerModule,\r\n    EmailNotVerifyExpiryComponent,\r\n    TranslateModule\r\n  ]\r\n})\r\nexport class EmailVerifyComponent implements OnInit {\r\n  params: ParamsEmailVerify | null = null;\r\n  mailmessage: string | undefined = '';\r\n  isLoading: boolean = true;\r\n  readonly LoadingForm = signal<boolean>(true);\r\n\r\n  constructor(\r\n    private cd: ChangeDetectorRef,\r\n    private zone: NgZone,\r\n    private router: Router,\r\n    private activatedRoute: ActivatedRoute,\r\n    private authService: AuthService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    // Utiliser NgZone pour garantir que les changements d'état sont détectés\r\n    this.zone.run(() => {\r\n      this.sendEmailVerifyService();\r\n    });\r\n  }\r\n\r\n  back() {\r\n    this.router.navigate(['/']);\r\n  }\r\n\r\n  sendEmailVerifyService() {\r\n    this.params = this.getParameterUrl(this.activatedRoute);\r\n\r\n    if (this.params) {\r\n      this.authService.emailverify(this.params).subscribe({\r\n        next: (response) => {\r\n          this.setStatus(response);\r\n          this.mailmessage = response.message;\r\n          this.markDetectChangeView();\r\n        },\r\n        error: (error: HttpErrorResponse) => {\r\n          this.mailmessage = error.error?.message || 'Erreur de vérification';\r\n          this.LoadingForm.set(false);\r\n          this.markDetectChangeView();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  setStatus(response: ResponseGlobalServer) {\r\n    const emailVerified = response.email_verified === true;\r\n    this.LoadingForm.set(emailVerified);\r\n    console.log('Email verified status:', emailVerified);\r\n  }\r\n  markDetectChangeView() {\r\n    this.cd.detectChanges();\r\n    // Mettre à jour l'état dans NgZone pour garantir la détection des changements\r\n    this.zone.run(() => {\r\n      this.isLoading = false;\r\n      // Force le rafraîchissement du composant\r\n      this.cd.detectChanges();\r\n    });\r\n    setTimeout(() => {\r\n      this.cd.detectChanges();\r\n    }, 100);\r\n  }\r\n\r\n  getParameterUrl(activatedRoute: ActivatedRoute): ParamsEmailVerify {\r\n    return {\r\n      id: activatedRoute.snapshot.paramMap.get('id') || '',\r\n      hash: activatedRoute.snapshot.paramMap.get('hash') || '',\r\n      uuid: activatedRoute.snapshot.paramMap.get('uuid') || '',\r\n      expires: activatedRoute.snapshot.queryParamMap.get('expires') || '',\r\n      signature: activatedRoute.snapshot.queryParamMap.get('signature') || ''\r\n    };\r\n  }\r\n}\r\n","<div *ngIf=\"LoadingForm()\" class=\"bg-pattern w-full h-full flex flex-col items-center justify-center\">\r\n  <div [@fadeInUp] class=\"card overflow-hidden w-full max-w-md\">\r\n    <div class=\"p-6 pb-0 flex flex-col items-center justify-center\" *ngIf=\"!isLoading\">\r\n      <div class=\"fill-current text-center\">\r\n        <img class=\"w-16\" src=\"assets/img/logo/logo.svg\" />\r\n      </div>\r\n      <h2 class=\"title m-0\">Notification For your E-mail verification</h2>\r\n    </div>\r\n\r\n    <div class=\"text-center mt-4 space-y-4\">\r\n      <ng-container *ngIf=\"isLoading; else emailVerifyFailed\">\r\n        <div class=\"p-4 flex items-center justify-center\">\r\n          <mat-progress-spinner mode=\"indeterminate\" color=\"primary\"></mat-progress-spinner>\r\n        </div>\r\n      </ng-container>\r\n      <ng-template #emailVerifyFailed>\r\n        <h4 class=\"body-2 text-lg font-light m-0\">\r\n          {{ mailmessage }}\r\n        </h4>\r\n      </ng-template>\r\n    </div>\r\n    <div class=\"p-6 flex flex-col\" *ngIf=\"!isLoading\">\r\n      <button (click)=\"back()\" color=\"primary\" mat-raised-button>\r\n        {{\"form.btn_next\" | translate}}\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-container *ngIf=\"!LoadingForm()\">\r\n  <vex-email-not-verify-expiry>\r\n  </vex-email-not-verify-expiry>\r\n</ng-container>"],"names":["NgIf","signal","MatButtonModule","MatIconModule","MatProgressSpinnerModule","fadeInUp400ms","EmailNotVerifyExpiryComponent","TranslateModule","i0","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵtext","ɵɵelementContainerStart","ɵɵelementContainerEnd","ɵɵadvance","ɵɵtextInterpolate1","ctx_r4","mailmessage","ɵɵlistener","EmailVerifyComponent_div_0_div_7_Template_button_click_1_listener","ɵɵrestoreView","_r8","ctx_r7","ɵɵnextContext","ɵɵresetView","back","ɵɵpipeBind1","ɵɵtemplate","EmailVerifyComponent_div_0_div_2_Template","EmailVerifyComponent_div_0_ng_container_4_Template","EmailVerifyComponent_div_0_ng_template_5_Template","ɵɵtemplateRefExtractor","EmailVerifyComponent_div_0_div_7_Template","ɵɵproperty","undefined","ctx_r0","isLoading","_r5","EmailVerifyComponent","constructor","cd","zone","router","activatedRoute","authService","params","LoadingForm","ngOnInit","run","sendEmailVerifyService","navigate","getParameterUrl","emailverify","subscribe","next","response","setStatus","message","markDetectChangeView","error","set","emailVerified","email_verified","console","log","detectChanges","setTimeout","id","snapshot","paramMap","get","hash","uuid","expires","queryParamMap","signature","ɵɵdirectiveInject","ChangeDetectorRef","NgZone","i1","Router","ActivatedRoute","i2","AuthService","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","EmailVerifyComponent_Template","rf","ctx","EmailVerifyComponent_div_0_Template","EmailVerifyComponent_ng_container_1_Template","i3","MatButton","i4","MatProgressSpinner","i5","TranslatePipe","styles","data","animation"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}