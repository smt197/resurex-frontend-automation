{"version":3,"file":"src_app_pages_document_document-create-update_document-create-update_component_ts.js","mappings":"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","sources":["./src/@vex/animations/fade-in-right.animation.ts","./src/@vex/animations/scale-fade-in.animation.ts","./src/@vex/animations/scale-in.animation.ts","./src/app/models/document.model.ts","./src/app/pages/document/document-create-update/document-create-update.component.ts","./src/app/pages/document/document-create-update/document-create-update.component.html"],"sourcesContent":["import { animate, style, transition, trigger } from '@angular/animations';\r\n\r\nexport function fadeInRightAnimation(duration: number) {\r\n  return trigger('fadeInRight', [\r\n    transition(':enter', [\r\n      style({\r\n        transform: 'translateX(-20px)',\r\n        opacity: 0\r\n      }),\r\n      animate(\r\n        `${duration}ms cubic-bezier(0.35, 0, 0.25, 1)`,\r\n        style({\r\n          transform: 'translateX(0)',\r\n          opacity: 1\r\n        })\r\n      )\r\n    ])\r\n  ]);\r\n}\r\n\r\nexport const fadeInRight400ms = fadeInRightAnimation(400);\r\n","import { animate, style, transition, trigger } from '@angular/animations';\r\n\r\nexport function scaleFadeInAnimation(duration: number) {\r\n  return trigger('scaleFadeIn', [\r\n    transition(':enter', [\r\n      style({\r\n        transform: 'scale(0.8)',\r\n        opacity: 0\r\n      }),\r\n      animate(\r\n        `${duration}ms cubic-bezier(0.35, 0, 0.25, 1)`,\r\n        style({\r\n          transform: 'scale(1)',\r\n          opacity: 1\r\n        })\r\n      )\r\n    ])\r\n  ]);\r\n}\r\n\r\nexport const scaleFadeIn400ms = scaleFadeInAnimation(400);\r\n","import { animate, style, transition, trigger } from '@angular/animations';\r\n\r\nexport function scaleInAnimation(duration: number) {\r\n  return trigger('scaleIn', [\r\n    transition(':enter', [\r\n      style({\r\n        transform: 'scale(0)'\r\n      }),\r\n      animate(\r\n        `${duration}ms cubic-bezier(0.35, 0, 0.25, 1)`,\r\n        style({\r\n          transform: 'scale(1)'\r\n        })\r\n      )\r\n    ])\r\n  ]);\r\n}\r\n\r\nexport const scaleIn400ms = scaleInAnimation(400);\r\n","import { FormlyFieldConfig } from '@ngx-formly/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { environment } from 'src/environments/environment';\r\nimport { DocumentAddFileModalComponent } from '../pages/document/document-add-file-modal/document-add-file-modal.component';\r\nimport { DocumentCreateUpdateComponent } from '../pages/document/document-create-update/document-create-update.component';\r\n\r\nexport function getDocumentCreationFormlyFields(\r\n  translate: TranslateService,\r\n  component: DocumentCreateUpdateComponent\r\n): FormlyFieldConfig[] {\r\n  return [\r\n    {\r\n      type: 'button',\r\n      className: 'flex justify-end mb-1',\r\n      props: {\r\n        text: translate.get('global.save'),\r\n        color: 'primary',\r\n        type: 'button',\r\n        className: 'mat-flat-button',\r\n        onClick: () => component.onSubmit()\r\n      },\r\n      expressionProperties: {\r\n        'props.disabled': 'field.form.invalid || formState.isLoading'\r\n      }\r\n    },\r\n    {\r\n      key: 'files',\r\n      type: 'document-file-pond', // Votre composant personnalisé pour l'upload\r\n      props: {\r\n        label: translate.instant('document.label.files'), // Nouvelle clé de traduction si besoin\r\n        required: true,\r\n        multiple: true, // C'est la clé !\r\n        maxWidth: '100%',\r\n        acceptedFileTypes: environment.extensions_files\r\n      }\r\n    }\r\n  ];\r\n}\r\n\r\nexport function getDocumentFormlyFields(\r\n  translate: TranslateService\r\n): FormlyFieldConfig[] {\r\n  const fields: FormlyFieldConfig[] = [\r\n    {\r\n      key: 'name',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('document.label.name'),\r\n        placeholder: translate.instant('document.label.name'),\r\n        required: true,\r\n        minLength: 3\r\n      },\r\n      validation: {\r\n        messages: {\r\n          required: 'Le nom est requis.',\r\n          minlength: 'Le nom doit contenir au moins 3 caractères.'\r\n        }\r\n      }\r\n    },\r\n    {\r\n      key: 'size',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('document.label.size'),\r\n        placeholder: translate.instant('document.label.size'),\r\n        readonly: true\r\n      }\r\n    }\r\n  ];\r\n\r\n  return fields;\r\n}\r\n\r\nexport function getFieldAddNewFile(\r\n  translate: TranslateService,\r\n  component?: DocumentAddFileModalComponent\r\n): FormlyFieldConfig[] {\r\n  return [\r\n    {\r\n      key: 'files',\r\n      type: 'document-file-pond',\r\n      props: {\r\n        label: translate.instant('document.label.files'),\r\n        placeholder: translate.instant('document.label.files'),\r\n        required: true,\r\n        multiple: true,\r\n        allowReorder: true,\r\n        acceptedFileTypes: environment.extensions_files\r\n      }\r\n    },\r\n    {\r\n      type: 'button',\r\n      className: 'flex justify-end mb-1',\r\n      props: {\r\n        text: translate.get('global.save'),\r\n        color: 'primary',\r\n        type: 'button',\r\n        className: 'mat-flat-button',\r\n        onClick: () => component?.uploadNewFiles()\r\n      },\r\n      expressionProperties: {\r\n        'props.disabled': 'field.form.invalid || formState.isLoading'\r\n      }\r\n    }\r\n  ];\r\n}\r\n\r\nexport function getFileFields(\r\n  translate: TranslateService,\r\n  Save: () => void,\r\n  isDisabled: () => boolean,\r\n  onFileChange?: (file: File) => void\r\n): FormlyFieldConfig[] {\r\n  return [\r\n    {\r\n      key: 'file',\r\n      type: 'filepond',\r\n      props: {\r\n        labelIdle: translate.instant('global.filepond.label_idle'),\r\n        acceptedFileTypes: environment.extensions_files,\r\n        required: true,\r\n        onChange: (file: File) => {\r\n          if (onFileChange) {\r\n            onFileChange(file); // Utilisez le callback au lieu de this\r\n          }\r\n        }\r\n      }\r\n    },\r\n    {\r\n      type: 'button',\r\n      props: {\r\n        text: translate.get('global.save'),\r\n        color: 'primary',\r\n        type: 'button',\r\n        disabled: !isDisabled,\r\n        className: 'mat-flat-button',\r\n        onClick: () => Save()\r\n      }\r\n    }\r\n  ];\r\n}\r\n\r\nexport function getJobStatusTableFields(\r\n  translate: TranslateService\r\n): FormlyFieldConfig[] {\r\n  return [\r\n    {\r\n      key: 'id',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('job_status.label.id'),\r\n        readonly: true\r\n      }\r\n    },\r\n    {\r\n      key: 'type',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('job_status.label.type'),\r\n        readonly: true\r\n      }\r\n    },\r\n    {\r\n      key: 'status',\r\n      type: 'select',\r\n      props: {\r\n        label: translate.instant('job_status.label.status'),\r\n        readonly: true,\r\n        options: [\r\n          {\r\n            label: translate.instant('job_status.status.queued'),\r\n            value: 'queued'\r\n          },\r\n          {\r\n            label: translate.instant('job_status.status.executing'),\r\n            value: 'executing'\r\n          },\r\n          {\r\n            label: translate.instant('job_status.status.finished'),\r\n            value: 'finished'\r\n          },\r\n          {\r\n            label: translate.instant('job_status.status.failed'),\r\n            value: 'failed'\r\n          },\r\n          {\r\n            label: translate.instant('job_status.status.retrying'),\r\n            value: 'retrying'\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      key: 'created_at',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('job_status.label.created_at'),\r\n        type: 'datetime-local',\r\n        readonly: true\r\n      }\r\n    }\r\n  ];\r\n}","import { Component, OnInit } from '@angular/core';\r\nimport { FormGroup, ReactiveFormsModule } from '@angular/forms';\r\nimport { FormlyFieldConfig } from '@ngx-formly/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { FormlyMaterialModule } from '@ngx-formly/material';\r\nimport { FormlyModule } from '@ngx-formly/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { getDocumentCreationFormlyFields } from 'src/app/models/document.model';\r\nimport { Router } from '@angular/router';\r\nimport { GenericApiService } from 'src/app/services/generic-api.service';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\nimport { LoadingSpinnerComponent } from 'src/app/auth/components/loading-spinner/loading-spinner.component';\r\nimport { fadeInRight400ms } from '@vex/animations/fade-in-right.animation';\r\nimport { fadeInUp400ms } from '@vex/animations/fade-in-up.animation';\r\nimport { scaleFadeIn400ms } from '@vex/animations/scale-fade-in.animation';\r\nimport { scaleIn400ms } from '@vex/animations/scale-in.animation';\r\nimport { stagger40ms } from '@vex/animations/stagger.animation';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { DocumentService } from '../document.service';\r\nimport { UploadStatusService } from 'src/app/services/upload-status.service';\r\n\r\n@Component({\r\n  selector: 'vex-document-create-update',\r\n  templateUrl: './document-create-update.component.html',\r\n  styleUrls: ['./document-create-update.component.scss'],\r\n  standalone: true,\r\n  animations: [\r\n    scaleIn400ms,\r\n    fadeInRight400ms,\r\n    stagger40ms,\r\n    fadeInUp400ms,\r\n    scaleFadeIn400ms\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    FormlyMaterialModule,\r\n    FormlyModule,\r\n    SharedModule,\r\n    ReactiveFormsModule,\r\n    MatProgressSpinnerModule,\r\n    MatProgressBarModule,\r\n    LoadingSpinnerComponent\r\n  ]\r\n})\r\nexport class DocumentCreateUpdateComponent implements OnInit {\r\n  form = new FormGroup({});\r\n  model: { files: File[] } = { files: [] };\r\n  fields: FormlyFieldConfig[] = [];\r\n  documentId: string | null = null;\r\n  isLoading = false;\r\n\r\n  constructor(\r\n    private translate: TranslateService,\r\n    private router: Router,\r\n    private genericApiService: GenericApiService,\r\n    private documentService: DocumentService,\r\n    private snackbar: MatSnackBar,\r\n    private uploadStatusService: UploadStatusService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.fields = getDocumentCreationFormlyFields(this.translate, this);\r\n  }\r\n\r\n  onSubmit(): void {\r\n    if (this.form.invalid) {\r\n      return;\r\n    }\r\n    const filesToUpload: File[] = this.model.files || [];\r\n\r\n    if (filesToUpload.length === 0) {\r\n      return;\r\n    }\r\n    this.isLoading = true;\r\n    const formData = new FormData();\r\n    const firstFile = filesToUpload[0];\r\n    const mainDocumentName =\r\n      firstFile.name.split('.').slice(0, -1).join('.') || firstFile.name;\r\n    formData.append('name', mainDocumentName);\r\n    formData.append('description', mainDocumentName);\r\n    filesToUpload.forEach((file) => {\r\n      formData.append('files[]', file, file.name);\r\n    });\r\n    this.genericApiService.create<any>('documents', formData).subscribe({\r\n      next: (response) => {\r\n        this.isLoading = false;\r\n\r\n        // Créer immédiatement le statut d'upload si on a un document ID\r\n        if (response?.data?.id) {\r\n          this.uploadStatusService.startUpload(\r\n            `doc-${response.data.id}`,\r\n            response.data.id\r\n          );\r\n\r\n          // Notifier qu'un nouveau document a été créé\r\n          this.documentService.notifyDocumentCreated(response.data);\r\n        }\r\n\r\n        this.showMessage(response?.message);\r\n        this.documentService.notifyJobCreated();\r\n      },\r\n      error: (err) => {\r\n        this.isLoading = false;\r\n        this.showMessage(err.error?.message);\r\n      }\r\n    });\r\n  }\r\n\r\n  back() {\r\n    this.router.navigate(['index/document']);\r\n  }\r\n\r\n  showMessage(params: string | undefined) {\r\n    if (params) {\r\n      this.snackbar.open(params, 'Fermer', { duration: 5000 });\r\n    }\r\n  }\r\n}\r\n","<div class=\"h-full flex flex-col\">\n  <!-- Header section -->\n  <div class=\"p-6 bg-foreground shadow-b flex-none border-b\">\n    <div class=\"container px-0\">\n      <div class=\"flex items-center justify-between\">\n        <h3 class=\"display-1 font-bold flex items-center\">\n          <span @scaleIn\n            class=\"w-12 h-12 rounded-full text-primary-600 ltr:mr-4 rtl:ml-4 flex items-center justify-center bg-primary-600/10\">\n            <mat-icon svgIcon=\"mat:attach_file\"></mat-icon>\n          </span>\n          <span @fadeInRight class=\"block\" rxTranslate=\"document.create.title\">TITLE</span>\n        </h3>\n\n        <button *ngIf=\"!isLoading\" (click)=\"back()\" class=\"flex-none hidden sm:inline-block\" color=\"primary\"\n          mat-flat-button type=\"button\">\n          <mat-icon class=\"ltr:mr-2 rtl:ml-2 ltr:-ml-1 rtl:-mr-1 icon-sm\" svgIcon=\"mat:arrow_back\"></mat-icon>\n          <span>Retour</span>\n        </button>\n      </div>\n    </div>\n  </div>\n  <!-- Files section -->\n  <div class=\"card overflow-y-auto flex-auto shadow-lg mt-4 border hover:border-solid hover:border-primary-500\">\n    <div class=\"p-6\">\n      <vex-loading-spinner *ngIf=\"isLoading\" mode=\"indeterminate\"></vex-loading-spinner>\n\n      <div *ngIf=\"!isLoading\">\n        <formly-form [form]=\"form\" [fields]=\"fields\" [model]=\"model\"\n          [options]=\"{ formState: { isLoading: isLoading } }\"></formly-form>\n      </div>\n    </div>\n  </div>\n</div>"],"names":["animate","style","transition","trigger","fadeInRightAnimation","duration","transform","opacity","fadeInRight400ms","scaleFadeInAnimation","scaleFadeIn400ms","scaleInAnimation","scaleIn400ms","environment","getDocumentCreationFormlyFields","translate","component","type","className","props","text","get","color","onClick","onSubmit","expressionProperties","key","label","instant","required","multiple","maxWidth","acceptedFileTypes","extensions_files","getDocumentFormlyFields","fields","placeholder","minLength","validation","messages","minlength","readonly","getFieldAddNewFile","allowReorder","uploadNewFiles","getFileFields","Save","isDisabled","onFileChange","labelIdle","onChange","file","disabled","getJobStatusTableFields","options","value","FormGroup","ReactiveFormsModule","MatButtonModule","MatIconModule","FormlyMaterialModule","FormlyModule","CommonModule","MatProgressSpinnerModule","MatProgressBarModule","SharedModule","LoadingSpinnerComponent","fadeInUp400ms","stagger40ms","i0","ɵɵelementStart","ɵɵlistener","DocumentCreateUpdateComponent_button_9_Template_button_click_0_listener","ɵɵrestoreView","_r4","ctx_r3","ɵɵnextContext","ɵɵresetView","back","ɵɵelement","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵproperty","ctx_r2","form","model","ɵɵpureFunction1","_c1","_c0","isLoading","DocumentCreateUpdateComponent","constructor","router","genericApiService","documentService","snackbar","uploadStatusService","files","documentId","ngOnInit","invalid","filesToUpload","length","formData","FormData","firstFile","mainDocumentName","name","split","slice","join","append","forEach","create","subscribe","next","response","data","id","startUpload","notifyDocumentCreated","showMessage","message","notifyJobCreated","error","err","navigate","params","open","ɵɵdirectiveInject","i1","TranslateService","i2","Router","i3","GenericApiService","i4","DocumentService","i5","MatSnackBar","i6","UploadStatusService","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","DocumentCreateUpdateComponent_Template","rf","ctx","ɵɵtemplate","DocumentCreateUpdateComponent_button_9_Template","DocumentCreateUpdateComponent_vex_loading_spinner_12_Template","DocumentCreateUpdateComponent_div_13_Template","undefined","i7","NgIf","i8","MatButton","i9","MatIcon","i10","FormlyForm","i11","default","styles","animation"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}