{"version":3,"file":"src_app_pages_maintenance-mode_maintenance-mode_component_ts.js","mappings":";;;;;;;;;;;;;;;;;;AACsE;AACQ;AAClB;;;;AAatD,MAAOG,uBAAuB;;;uBAAvBA,uBAAuB;IAAA;EAAA;;;YAAvBA,uBAAuB;MAAAC,SAAA;MAAAC,UAAA;MAAAC,QAAA,GAAAC,iEAAA;MAAAE,KAAA;MAAAC,IAAA;MAAAC,MAAA;MAAAC,QAAA,WAAAC,iCAAAC,EAAA,EAAAC,GAAA;QAAA,IAAAD,EAAA;UChBpCP,4DAAA,aAAwD;UAEAA,oDAAA,qBAAc;UAAAA,0DAAA,EAAO;UAG7EA,uDAAA,8BAAiH;UACjHA,0DAAA,EAAM;;;qBDGHP,gFAAoB,EACnBC,wFAAwB,EAAAmB,kFAAA,EACxBlB,sEAAY,EAAAoB,4EAAA;MAAAE,MAAA;IAAA;EAAA;;;;;;;;;;;;;;;;;;;;;;;;;AEX0C;AACX;AACY;AACJ;AACA;AACK;AACW;AACjB;AACsD;AAC5C;;;;;;;ICP9DjB,4DAAA,aAAmG;IACjGA,uDAAA,0BAA2C;IAC7CA,0DAAA,EAAM;;;;;IAGNA,4DAAA,aAAgG;IAG5FA,uDAAA,kBAA+D;IACjEA,0DAAA,EAAM;IAGNA,4DAAA,YAAsD;IACpDA,oDAAA,GACF;;IAAAA,0DAAA,EAAK;IAGLA,4DAAA,aAAuB;IACrBA,uDAAA,aAA0E;IAC5EA,0DAAA,EAAM;IAGNA,4DAAA,cAAqD;IAEjDA,oDAAA,IACF;;IAAAA,0DAAA,EAAI;;;;IAZJA,uDAAA,GACF;IADEA,gEAAA,MAAAA,yDAAA,0CACF;IAIqCA,uDAAA,GAAgC;IAAhCA,wDAAA,cAAAgC,MAAA,CAAAC,kBAAA,EAAAjC,4DAAA,CAAgC;IAMjEA,uDAAA,GACF;IADEA,gEAAA,MAAAA,yDAAA,gDACF;;;ADFA,MAAOmC,wBAAwB;EAdrCC,YAAA;IAemB,KAAAC,WAAW,GAAGnB,qDAAM,CAACM,sEAAW,CAAC;IACjC,KAAAc,gBAAgB,GAAGpB,qDAAM,CAACO,iFAAgB,CAAC;IAC3C,KAAAc,MAAM,GAAGrB,qDAAM,CAACI,mDAAM,CAAC;IAExC,KAAAW,kBAAkB,GAAW,2DAA2D;IACxF,KAAAO,cAAc,GAAY,IAAI;;EAE9BC,QAAQA,CAAA;IACN;IACA,MAAMC,IAAI,GAAG,IAAI,CAACL,WAAW,CAACK,IAAI;IAClC,IAAIA,IAAI,IAAIA,IAAI,CAACC,KAAK,EAAEC,IAAI,CAACC,IAAI,IAAIA,IAAI,CAACC,IAAI,KAAKnB,0EAAS,CAACoB,KAAK,CAAC,EAAE;MACnE;MACA,IAAI,CAACR,MAAM,CAACS,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;MAChC;;IAGF;IACA,IAAI,CAACX,WAAW,CAACY,YAAY,EAAE,CAACC,SAAS,CAAC;MACxCC,IAAI,EAAGC,QAAQ,IAAI;QACjB,MAAMV,IAAI,GAAGU,QAAQ,CAACV,IAAI;QAC1B,IAAIA,IAAI,IAAIA,IAAI,CAACC,KAAK,EAAEC,IAAI,CAACC,IAAI,IAAIA,IAAI,CAACC,IAAI,KAAKnB,0EAAS,CAACoB,KAAK,CAAC,EAAE;UACnE;UACA,IAAI,CAACR,MAAM,CAACS,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;UAChC;;QAEF;QACA,IAAI,CAACR,cAAc,GAAG,KAAK;QAC3B,IAAI,CAACa,sBAAsB,EAAE;MAC/B,CAAC;MACDC,KAAK,EAAEA,CAAA,KAAK;QACV;QACA,IAAI,CAACd,cAAc,GAAG,KAAK;QAC3B,IAAI,CAACa,sBAAsB,EAAE;MAC/B;KACD,CAAC;EACJ;EAEQA,sBAAsBA,CAAA;IAC5B,IAAI,CAACf,gBAAgB,CAACiB,oBAAoB,EAAE,CAACL,SAAS,CAAC;MACrDC,IAAI,EAAGC,QAAQ,IAAI;QACjB,IAAIA,QAAQ,CAACI,OAAO,EAAE;UACpB,IAAI,CAACvB,kBAAkB,GAAGmB,QAAQ,CAACI,OAAO;;MAE9C;KACD,CAAC;EACJ;EAEAC,cAAcA,CAAA;IACZ,IAAI,CAAClB,MAAM,CAACS,QAAQ,CAAC,CAAC,cAAc,CAAC,CAAC;EACxC;;;uBAlDWb,wBAAwB;IAAA;EAAA;;;YAAxBA,wBAAwB;MAAAtC,SAAA;MAAAC,UAAA;MAAAC,QAAA,GAAAC,iEAAA;MAAAE,KAAA;MAAAC,IAAA;MAAAC,MAAA;MAAAC,QAAA,WAAAqD,kCAAAnD,EAAA,EAAAC,GAAA;QAAA,IAAAD,EAAA;UCzBrCP,4DAAA,aAA8F;UAE5FA,wDAAA,IAAA4D,uCAAA,iBAEM,IAAAC,uCAAA;UAiCR7D,0DAAA,EAAM;;;UAnCEA,uDAAA,EAAoB;UAApBA,wDAAA,SAAAQ,GAAA,CAAAgC,cAAA,CAAoB;UAKpBxC,uDAAA,EAAqB;UAArBA,wDAAA,UAAAQ,GAAA,CAAAgC,cAAA,CAAqB;;;qBDQzBrB,yDAAY,EAAAN,iDAAA,EACZO,qEAAe,EACfC,iEAAa,EAAAN,2DAAA,EACbQ,yDAAY,EACZG,gEAAe,EAAAsC,8DAAA,EACfpE,sHAAuB;MAAAqB,MAAA;IAAA;EAAA","sources":["./src/app/auth/components/loading-spinner/loading-spinner.component.ts","./src/app/auth/components/loading-spinner/loading-spinner.component.html","./src/app/pages/maintenance-mode/maintenance-mode.component.ts","./src/app/pages/maintenance-mode/maintenance-mode.component.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\n\r\n@Component({\r\n  selector: 'vex-loading-spinner',\r\n  standalone: true,\r\n  imports: [\r\n   MatProgressBarModule,\r\n    MatProgressSpinnerModule,\r\n    SharedModule\r\n  ],\r\n  templateUrl: './loading-spinner.component.html',\r\n  styleUrls: ['../../auth.component.scss']\r\n})\r\nexport class LoadingSpinnerComponent {\r\n\r\n}\r\n","<div class=\"flex flex-col items-center justify-center \">\r\n    <button color=\"primary\" mat-raised-button>\r\n    <span class=\"text-lg \" rxTranslate=\"global.loading\">Please wait...</span>\r\n   \r\n</button>\r\n<mat-progress-spinner mode=\"indeterminate\" class=\"icon-2xl\" color=\"primary\" diameter=\"35\"></mat-progress-spinner>\r\n</div>","import { Component, OnInit, inject } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { Router, RouterModule } from '@angular/router';\r\nimport { AuthService } from 'src/app/services/auth-service';\r\nimport { AdminAuthService } from 'src/app/services/admin-auth.service';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { LoadingSpinnerComponent } from 'src/app/auth/components/loading-spinner/loading-spinner.component';\r\nimport { Authority } from 'src/static-data/authority.constants';\r\n\r\n@Component({\r\n  selector: 'vex-maintenance-mode',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    RouterModule,\r\n    TranslateModule,\r\n    LoadingSpinnerComponent\r\n  ],\r\n  templateUrl: './maintenance-mode.component.html',\r\n  styleUrl: './maintenance-mode.component.scss'\r\n})\r\nexport class MaintenanceModeComponent implements OnInit {\r\n  private readonly authService = inject(AuthService);\r\n  private readonly adminAuthService = inject(AdminAuthService);\r\n  private readonly router = inject(Router);\r\n\r\n  maintenanceMessage: string = 'Application en maintenance. Veuillez réessayer plus tard.';\r\n  isCheckingAuth: boolean = true;\r\n\r\n  ngOnInit(): void {\r\n    // Vérification immédiate de l'authentification en mémoire\r\n    const user = this.authService.user;\r\n    if (user && user.roles?.some(role => role.name === Authority.ADMIN)) {\r\n      // Admin déjà authentifié : redirection immédiate\r\n      this.router.navigate(['/index']);\r\n      return;\r\n    }\r\n\r\n    // Vérifier avec le serveur si l'admin est connecté\r\n    this.authService.authenticate().subscribe({\r\n      next: (response) => {\r\n        const user = response.user;\r\n        if (user && user.roles?.some(role => role.name === Authority.ADMIN)) {\r\n          // Admin connecté : rediriger vers /index\r\n          this.router.navigate(['/index']);\r\n          return;\r\n        }\r\n        // Utilisateur normal : charger le message de maintenance\r\n        this.isCheckingAuth = false;\r\n        this.loadMaintenanceMessage();\r\n      },\r\n      error: () => {\r\n        // En cas d'erreur, charger le message de maintenance\r\n        this.isCheckingAuth = false;\r\n        this.loadMaintenanceMessage();\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadMaintenanceMessage(): void {\r\n    this.adminAuthService.getMaintenanceStatus().subscribe({\r\n      next: (response) => {\r\n        if (response.message) {\r\n          this.maintenanceMessage = response.message;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  goToAdminLogin(): void {\r\n    this.router.navigate(['/login/admin']);\r\n  }\r\n}\r\n","<div class=\"min-h-screen flex items-center justify-center px-4 bg-cover bg-center bg-pattern\">\r\n  <!-- Afficher le spinner pendant la vérification de l'authentification -->\r\n  <div *ngIf=\"isCheckingAuth\" class=\"card shadow-xl text-center w-full max-w-md overflow-hidden p-8\">\r\n    <vex-loading-spinner></vex-loading-spinner>\r\n  </div>\r\n\r\n  <!-- Afficher le message de maintenance une fois la vérification terminée -->\r\n  <div *ngIf=\"!isCheckingAuth\" class=\"card shadow-xl text-center w-full max-w-md overflow-hidden\">\r\n    <!-- Header avec icône -->\r\n    <div class=\"p-6 flex flex-col items-center\">\r\n      <mat-icon class=\"text-8xl mb-4\" svgIcon=\"mat:build\"></mat-icon>\r\n    </div>\r\n\r\n    <!-- Titre principal -->\r\n    <h1 class=\"display-1 font-medium m-0 text-orange-600\">\r\n      {{ 'admin_maintenance.en_cours' | translate }}\r\n    </h1>\r\n\r\n    <!-- Message personnalisé -->\r\n    <div class=\"px-6 py-4\">\r\n      <div class=\"text-lg text-gray-700\" [innerHTML]=\"maintenanceMessage\"></div>\r\n    </div>\r\n\r\n    <!-- Footer avec boutons -->\r\n    <div class=\"bg-app-bar p-6 flex flex-col gap-3 mt-6\">\r\n      <p class=\"mt-0 mb-2 text-sm text-gray-600\">\r\n        {{\"admin_maintenance.message_label\" | translate}}\r\n      </p>\r\n      <!-- <button\r\n        mat-raised-button\r\n        color=\"primary\"\r\n        (click)=\"goToAdminLogin()\"\r\n        class=\"w-full\">\r\n        Connexion Administrateur\r\n      </button> -->\r\n    </div>\r\n  </div>\r\n</div>\r\n"],"names":["MatProgressBarModule","MatProgressSpinnerModule","SharedModule","LoadingSpinnerComponent","selectors","standalone","features","i0","ɵɵStandaloneFeature","decls","vars","consts","template","LoadingSpinnerComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","i1","MatProgressSpinner","i2","default","styles","inject","CommonModule","MatButtonModule","MatIconModule","Router","RouterModule","AuthService","AdminAuthService","TranslateModule","Authority","ɵɵadvance","ɵɵtextInterpolate1","ɵɵpipeBind1","ɵɵproperty","ctx_r1","maintenanceMessage","ɵɵsanitizeHtml","MaintenanceModeComponent","constructor","authService","adminAuthService","router","isCheckingAuth","ngOnInit","user","roles","some","role","name","ADMIN","navigate","authenticate","subscribe","next","response","loadMaintenanceMessage","error","getMaintenanceStatus","message","goToAdminLogin","MaintenanceModeComponent_Template","ɵɵtemplate","MaintenanceModeComponent_div_1_Template","MaintenanceModeComponent_div_2_Template","NgIf","MatIcon","i3","TranslatePipe"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}