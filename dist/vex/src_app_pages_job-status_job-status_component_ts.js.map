{"version":3,"file":"src_app_pages_job-status_job-status_component_ts.js","mappings":"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","sources":["./src/app/models/document.model.ts","./src/app/pages/job-status/job-status.component.ts","./src/app/pages/job-status/job-status.component.html"],"sourcesContent":["import { FormlyFieldConfig } from '@ngx-formly/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { environment } from 'src/environments/environment';\r\nimport { DocumentAddFileModalComponent } from '../pages/document/document-add-file-modal/document-add-file-modal.component';\r\nimport { DocumentCreateUpdateComponent } from '../pages/document/document-create-update/document-create-update.component';\r\n\r\nexport function getDocumentCreationFormlyFields(\r\n  translate: TranslateService,\r\n  component: DocumentCreateUpdateComponent\r\n): FormlyFieldConfig[] {\r\n  return [\r\n    {\r\n      type: 'button',\r\n      className: 'flex justify-end mb-1',\r\n      props: {\r\n        text: translate.get('global.save'),\r\n        color: 'primary',\r\n        type: 'button',\r\n        className: 'mat-flat-button',\r\n        onClick: () => component.onSubmit()\r\n      },\r\n      expressionProperties: {\r\n        'props.disabled': 'field.form.invalid || formState.isLoading'\r\n      }\r\n    },\r\n    {\r\n      key: 'files',\r\n      type: 'document-file-pond', // Votre composant personnalisé pour l'upload\r\n      props: {\r\n        label: translate.instant('document.label.files'), // Nouvelle clé de traduction si besoin\r\n        required: true,\r\n        multiple: true, // C'est la clé !\r\n        maxWidth: '100%',\r\n        acceptedFileTypes: environment.extensions_files\r\n      }\r\n    }\r\n  ];\r\n}\r\n\r\nexport function getDocumentFormlyFields(\r\n  translate: TranslateService\r\n): FormlyFieldConfig[] {\r\n  const fields: FormlyFieldConfig[] = [\r\n    {\r\n      key: 'name',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('document.label.name'),\r\n        placeholder: translate.instant('document.label.name'),\r\n        required: true,\r\n        minLength: 3\r\n      },\r\n      validation: {\r\n        messages: {\r\n          required: 'Le nom est requis.',\r\n          minlength: 'Le nom doit contenir au moins 3 caractères.'\r\n        }\r\n      }\r\n    },\r\n    {\r\n      key: 'size',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('document.label.size'),\r\n        placeholder: translate.instant('document.label.size'),\r\n        readonly: true\r\n      }\r\n    }\r\n  ];\r\n\r\n  return fields;\r\n}\r\n\r\nexport function getFieldAddNewFile(\r\n  translate: TranslateService,\r\n  component?: DocumentAddFileModalComponent\r\n): FormlyFieldConfig[] {\r\n  return [\r\n    {\r\n      key: 'files',\r\n      type: 'document-file-pond',\r\n      props: {\r\n        label: translate.instant('document.label.files'),\r\n        placeholder: translate.instant('document.label.files'),\r\n        required: true,\r\n        multiple: true,\r\n        allowReorder: true,\r\n        acceptedFileTypes: environment.extensions_files\r\n      }\r\n    },\r\n    {\r\n      type: 'button',\r\n      className: 'flex justify-end mb-1',\r\n      props: {\r\n        text: translate.get('global.save'),\r\n        color: 'primary',\r\n        type: 'button',\r\n        className: 'mat-flat-button',\r\n        onClick: () => component?.uploadNewFiles()\r\n      },\r\n      expressionProperties: {\r\n        'props.disabled': 'field.form.invalid || formState.isLoading'\r\n      }\r\n    }\r\n  ];\r\n}\r\n\r\nexport function getFileFields(\r\n  translate: TranslateService,\r\n  Save: () => void,\r\n  isDisabled: () => boolean,\r\n  onFileChange?: (file: File) => void\r\n): FormlyFieldConfig[] {\r\n  return [\r\n    {\r\n      key: 'file',\r\n      type: 'filepond',\r\n      props: {\r\n        labelIdle: translate.instant('global.filepond.label_idle'),\r\n        acceptedFileTypes: environment.extensions_files,\r\n        required: true,\r\n        onChange: (file: File) => {\r\n          if (onFileChange) {\r\n            onFileChange(file); // Utilisez le callback au lieu de this\r\n          }\r\n        }\r\n      }\r\n    },\r\n    {\r\n      type: 'button',\r\n      props: {\r\n        text: translate.get('global.save'),\r\n        color: 'primary',\r\n        type: 'button',\r\n        disabled: !isDisabled,\r\n        className: 'mat-flat-button',\r\n        onClick: () => Save()\r\n      }\r\n    }\r\n  ];\r\n}\r\n\r\nexport function getJobStatusTableFields(\r\n  translate: TranslateService\r\n): FormlyFieldConfig[] {\r\n  return [\r\n    {\r\n      key: 'id',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('job_status.label.id'),\r\n        readonly: true\r\n      }\r\n    },\r\n    {\r\n      key: 'type',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('job_status.label.type'),\r\n        readonly: true\r\n      }\r\n    },\r\n    {\r\n      key: 'status',\r\n      type: 'select',\r\n      props: {\r\n        label: translate.instant('job_status.label.status'),\r\n        readonly: true,\r\n        options: [\r\n          {\r\n            label: translate.instant('job_status.status.queued'),\r\n            value: 'queued'\r\n          },\r\n          {\r\n            label: translate.instant('job_status.status.executing'),\r\n            value: 'executing'\r\n          },\r\n          {\r\n            label: translate.instant('job_status.status.finished'),\r\n            value: 'finished'\r\n          },\r\n          {\r\n            label: translate.instant('job_status.status.failed'),\r\n            value: 'failed'\r\n          },\r\n          {\r\n            label: translate.instant('job_status.status.retrying'),\r\n            value: 'retrying'\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      key: 'created_at',\r\n      type: 'input',\r\n      props: {\r\n        label: translate.instant('job_status.label.created_at'),\r\n        type: 'datetime-local',\r\n        readonly: true\r\n      }\r\n    }\r\n  ];\r\n}","import { Component, OnInit, ViewChild, signal } from '@angular/core'; // Added OnInit\r\nimport { CommonModule } from '@angular/common';\r\nimport { GenericResourceListComponent } from 'src/app/shared/generic-resource-list/generic-resource-list.component';\r\nimport { ActionEvent } from 'src/app/shared/dynamic-data-table/Dynamic-Table-Interface';\r\nimport { getJobStatusTableFields } from 'src/app/models/document.model';\r\nimport { ResourceService } from 'src/app/shared/generic-resource-list/generic-method-interface';\r\nimport { GenericApiService } from 'src/app/services/generic-api.service';\r\nimport { TranslateModule, TranslateService } from '@ngx-translate/core';\r\nimport { Observable } from 'rxjs';\r\nimport { FormlyFieldConfig } from '@ngx-formly/core';\r\nimport { DocumentService } from '../document/document.service';\r\nimport { JobStatus } from 'src/app/interfaces/JobStatus';\r\nimport { ResponseGenericApi } from 'src/app/interfaces/responseGenericApi';\r\n\r\n@Component({\r\n  selector: 'vex-job-status',\r\n  standalone: true,\r\n  imports: [CommonModule, GenericResourceListComponent, TranslateModule],\r\n  templateUrl: './job-status.component.html',\r\n  styleUrl: './job-status.component.scss'\r\n})\r\nexport class JobStatusComponent implements OnInit {\r\n  type = 'user-jobs';\r\n  isLoading = signal(true);\r\n  dataService: ResourceService<JobStatus>;\r\n  activeJobsCount$: Observable<number>;\r\n  @ViewChild(GenericResourceListComponent)\r\n  resourceList!: GenericResourceListComponent<JobStatus>;\r\n  formlyFields: FormlyFieldConfig[] = [];\r\n\r\n  constructor(\r\n    private genericApi: GenericApiService,\r\n    private translate: TranslateService,\r\n    private documentService: DocumentService\r\n  ) {\r\n   this.dataService = {\r\n     getAll: (page: number, perPage: number) =>\r\n        this.genericApi.getAll<JobStatus>(this.type, page, perPage),\r\n     getAllSimple: (ressource = this.type) =>\r\n        this.genericApi.getAllSimple<ResponseGenericApi<JobStatus[]>>(ressource),\r\n      search: (term) => this.genericApi.search<JobStatus>(this.type, term)\r\n    };\r\n    this.activeJobsCount$ = this.documentService.activeJobsCount$;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.formlyFields = getJobStatusTableFields(this.translate);\r\n  }\r\n\r\n  handleAction(event: ActionEvent<JobStatus>) {}\r\n}\r\n","<vex-generic-resource-list\r\n  [type]=\"type\"\r\n  [formlyFields]=\"formlyFields\"\r\n  [dataService]=\"dataService\"\r\n  [activeJobsCount]=\"(activeJobsCount$ | async) || 0\"\r\n  (action)=\"handleAction($event)\">\r\n</vex-generic-resource-list>"],"names":["environment","getDocumentCreationFormlyFields","translate","component","type","className","props","text","get","color","onClick","onSubmit","expressionProperties","key","label","instant","required","multiple","maxWidth","acceptedFileTypes","extensions_files","getDocumentFormlyFields","fields","placeholder","minLength","validation","messages","minlength","readonly","getFieldAddNewFile","allowReorder","uploadNewFiles","getFileFields","Save","isDisabled","onFileChange","labelIdle","onChange","file","disabled","getJobStatusTableFields","options","value","signal","CommonModule","GenericResourceListComponent","TranslateModule","JobStatusComponent","constructor","genericApi","documentService","isLoading","formlyFields","dataService","getAll","page","perPage","getAllSimple","ressource","search","term","activeJobsCount$","ngOnInit","handleAction","event","i0","ɵɵdirectiveInject","i1","GenericApiService","i2","TranslateService","i3","DocumentService","selectors","viewQuery","JobStatusComponent_Query","rf","ctx","ɵɵelementStart","ɵɵlistener","JobStatusComponent_Template_vex_generic_resource_list_action_0_listener","$event","ɵɵelementEnd","ɵɵproperty","ɵɵpipeBind1","i4","AsyncPipe","styles"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}