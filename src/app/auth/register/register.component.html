<div class="w-full h-full bg-pattern flex items-center justify-center p-4">
  <div @fadeInUp class="card overflow-hidden w-full max-w-6xl">
    <div class="grid grid-cols-1 md:grid-cols-2">
      <!-- Colonne gauche - Descriptif -->
      <div class="bg-slate-100 dark:bg-slate-800 flex flex-col justify-center p-6 sm:p-8">
        <!-- Logo -->
        <div class="pb-4 flex flex-col items-center justify-center">
          <div class="fill-current text-center" *ngIf="authService.image$ | async as site_logo">
            <img class="w-12 md:w-16" [src]="site_logo" alt="Logo" />
          </div>
        </div>
        <div class="flex flex-col items-center">
          <h1 class="capitalize text-2xl sm:text-3xl md:text-4xl font-bold text-slate-800 dark:text-white text-center">
            {{ authService.site_subtitle$ | async }}
          </h1>
        </div>
      </div>

      <!-- Colonne droite - Formulaire d'inscription -->
      <div class="flex flex-col w-full p-6">
        <ng-container>
          <div @stagger class="container">
            <ng-container *ngIf="!sucess ; else failed">
              <ng-container *ngIf="!isLoading; else loadingSpinner">
                <div @fadeInUp class="overflow-hidden">
                  <h2 class="title mb-4 flex flex-col sm:flex-row sm:items-center">
                    <span class="flex flex-col">
                      <span class="body-2 text-secondary m-0 text-sm sm:text-base" rxTranslate="register.subtile">Simply
                        fill out the form below</span>
                    </span>
                  </h2>
                  <div class="text-center p-2 sm:p-4" *ngFor="let error of errorMessage">
                    <div *ngIf="error && error.email" class="text-red-500 text-lg font-medium">
                      {{ error.email[0] }}
                    </div>
                  </div>
                  <mat-horizontal-stepper #stepper="matHorizontalStepper" [linear]="true"
                    [orientation]="(isSmallScreen$ | async) ? 'vertical' : 'horizontal'">
                    <ng-template matStepperIcon="edit">
                      <mat-icon svgIcon="mat:done_all"></mat-icon>
                    </ng-template>

                    <ng-template matStepperIcon="done">
                      <mat-icon svgIcon="mat:done_all"></mat-icon>
                    </ng-template>

                    <mat-step [stepControl]="accountFormGroup" labelPosition="end">
                      <form [formGroup]="accountFormGroup">
                        <ng-template matStepLabel><span rxTranslate="register.step.label_step1">Create
                            Account</span></ng-template>

                        <h2 class="title m-0 text-lg sm:text-xl" rxTranslate="register.step.label_step1">Create Account
                        </h2>

                        <div class="mt-4">
                          <formly-form [form]="accountFormGroup" [fields]="accountfields"
                            [model]="accountModel"></formly-form>
                        </div>
                        <div class="actions flex items-center justify-end gap-2 mt-6">
                          <button (click)="stepper.reset()" [disabled]="accountFormGroup.pristine" color="primary"
                            mat-button type="button" rxTranslate="form.btn_reset">Reset</button>
                          <button [disabled]="accountFormGroup.invalid" rxTranslate="form.btn_next" color="primary"
                            mat-flat-button matStepperNext>Next</button>
                        </div>
                      </form>
                    </mat-step>

                    <mat-step [stepControl]="PasswordFormGroup" labelPosition="end">
                      <form [formGroup]="PasswordFormGroup">
                        <ng-template matStepLabel><span rxTranslate="register.step.label_step2">Select a
                            Password</span></ng-template>

                        <h2 class="title m-0 text-lg sm:text-xl" rxTranslate="register.step.label_step2">Select a
                          Password</h2>

                        <div class="mt-4">
                          <formly-form [form]="PasswordFormGroup" [fields]="passwordFields"
                            [model]="passwordModel"></formly-form>
                        </div>

                        <div class="actions flex items-center justify-end gap-2 mt-6">
                          <button color="primary" mat-button matStepperPrevious type="button"
                            rxTranslate="form.btn_previous">Previous</button>
                          <button [disabled]="PasswordFormGroup.invalid" color="primary" mat-flat-button matStepperNext
                            rxTranslate="form.btn_next">Next</button>
                        </div>
                      </form>
                    </mat-step>

                    <mat-step [stepControl]="confirmFormGroup" labelPosition="end">
                      <form [formGroup]="confirmFormGroup">
                        <ng-template matStepLabel><span rxTranslate="register.step.label_step3">Confirm
                            Creation</span></ng-template>

                        <div class="title m-0 text-lg sm:text-xl" rxTranslate="register.step.label_step3">You're almost
                          there!</div>

                        <div class="mt-4 flex flex-col gap-2">
                          <formly-form [form]="confirmFormGroup" [model]="confirmModel"
                            [fields]="confirmFormFields"></formly-form>
                        </div>

                        <ng-container *ngIf="!isLoading; else loadingTemplate">
                          <div class="actions flex items-center justify-end gap-2 mt-6">
                            <button color="primary" mat-button matStepperPrevious type="button"
                              rxTranslate="form.btn_previous">Previous</button>
                            <button [disabled]="confirmFormGroup.invalid" (click)="submit()" color="primary"
                              mat-flat-button><span rxTranslate="register.submit">Create Account</span></button>
                          </div>
                        </ng-container>
                        <ng-template #loadingTemplate>
                          <div class="actions flex items-center justify-center mt-4">
                            <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
                          </div>
                        </ng-template>
                      </form>
                    </mat-step>
                  </mat-horizontal-stepper>
                </div>
              </ng-container>
              <ng-template #loadingSpinner>
                <div class="flex items-center justify-center min-h-[300px]">
                  <vex-loading-spinner></vex-loading-spinner>
                </div>
              </ng-template>
            </ng-container>
            <ng-template class="subheading-1" #failed>
              <div class="flex flex-col items-center p-4">
                <div
                  class="p-4 sm:p-6 rounded-full bg-primary-600/10 text-primary-600 mx-auto flex items-center justify-center">
                  <mat-icon class="icon-3xl sm:icon-5xl" svgIcon="mat:check"></mat-icon>
                </div>
                <p class="text-lg sm:text-xl font-bold mt-6 sm:mt-10 text-center">
                  {{ mailmessage }}
                </p>
              </div>
            </ng-template>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>